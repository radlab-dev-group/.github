<section class="tech-section" id="request-flow"
         style="background: radial-gradient(circle at 50% 0%, rgba(56, 189, 248, 0.08), transparent 60%), #020617; padding: 3rem 0;">
    <div class="container">
        <h2 class="section-title">Request Flow</h2>
        <p class="section-subtitle">How a request travels through the system</p>

        <div class="flow-diagram">
            <div class="flow-step">
                <strong>1. Request Ingress</strong> – Flask receives HTTP request at registered endpoint
            </div>
            <div class="flow-step">
                <strong>2. Parameter Extraction</strong> – FlaskEndpointRegistrar extracts JSON/form params
            </div>
            <div class="flow-step">
                <strong>3. Endpoint Dispatch</strong> – run_ep() called on concrete EndpointI subclass
            </div>
            <div class="flow-step">
                <strong>4. Payload Preparation</strong> – prepare_payload() normalizes params, validates required args
            </div>
            <div class="flow-step">
                <strong>5. Model Resolution</strong> – get_model_provider() resolves model name via ModelHandler
            </div>
            <div class="flow-step">
                <strong>6. Provider Selection</strong> – ProviderChooser picks provider using configured strategy
            </div>
            <div class="flow-step">
                <strong>7. Prompt Injection</strong> – (optional) System prompt injected from PromptHandler
            </div>
            <div class="flow-step">
                <strong>8. HTTP Execution</strong> – HttpRequestExecutor sends request to external LLM API
            </div>
            <div class="flow-step">
                <strong>9. Response Handling</strong> – Response parsed, optionally streamed via SSE
            </div>
            <div class="flow-step">
                <strong>10. Retry Logic</strong> – (on failure) Automatic retry with backoff, up to MAX_RECONNECTIONS
            </div>
        </div>
    </div>
</section>